# 기능 명세서

- 방 만들기 기능

- 닉네임 설정 기능

- 게임 링크 복사 기능

- 게임 준비 상태 변경 기능

  - 방에 참여한 모든 사용자는 준비 상태를 변경할 수 있다.

- 게임 시작 기능

  - 방에 참여한 모든 사용자의 준비 상태가 '준비' 상태가 되면 게임을 시작한다.

- 게임 시작 시 해당 링크로 접속 금지 기능

- 게임 참여자 직업 랜덤 배정 기능

  - 4 ~ 5명
    - 마피아: 1
    - 의사: 1
    - 시민: 전체 - 2
  - 6 ~ 8명
    - 마피아: 2
    - 의사: 1
    - 시민: 전체 - 3

- 알림 기능

  - 배정된 직업 알림

- 단계 전환 기능

  - 각 단계의 제한 시간이 흐른 뒤에 다음 단계로 전환
  - 직업 공지 ==> 낮 (토론 --> 지목 투표 --> 최후의 변론 --> 사형 투표) ==> (종료조건 확인 + 결과 공지)-낮 ==> 밤 (마피아 투표 -->의사 투표) ==> (종료조건 확인 + 결과 공지)-밤 ==> 낮

- 각 단계별 투표완료 이벤트 발생 시 단계 전환 기능

  - 게임의 한 사이클에 투표는 총 4번이 있다.
  - 각 단계에서 제한 시간 내에 투표가 완료될 시 정해진 다음 단계로 즉시 전환

  | 단계        | 이벤트(조건)                                         | 다음 단계                 |
  | ----------- | ---------------------------------------------------- | ------------------------- |
  | 토론        | 모든 생존 사용자 지목 투표 완료                      | 최후의 변론               |
  | 사형 투표   | 사형 투표 대상자를 제외한 모든 생존 사용자 투표 완료 | 종료조건 확인 + 결과 공지 |
  | 마피아 투표 | 모든 생존 마피아 사용자 투표 완료                    | 의사 투표                 |
  | 의사 투표   | 의사 사용자 투표 완료                                | 종료조건 확인 + 결과 공지 |

- 프로필 투표 기능
  - 사용 단계: 지목 투표, 마피아 투표, 의사 투표
  - 사용자 화상화면을 클릭하여 투표
  - Skip 버튼을 통해 무효표도 가능
  - 투표를 받은 사용자의 화상화면 아래에 해당 사용자를 투표한 사용자들의 프로필 표시
  - 동률일 경우, 아무 일도 일어나지 않고 다음 단계로 이동
  
- 단독 발언 기능
  - 사용 단계: 최후의 변론
  - 지목 투표 결과 가장 많은 표를 받은 사용자를 제외한 모두의 음성를 음소거
  
- 팝업 투표 기능
  - 사용 단계: 사형 투표
  - 팝업 형태로 사용자에게 찬성과 반대 버튼을 제공
  - 모든 사용자는 버튼을 클릭하여 투표
  - 투표를 한 사용자의 화상화면 아래에 찬성 / 반대 아이콘 표시
  - 동률일 경우, 아무 일도 일어나지 않고 다음 단계로 이동
  
- 마피아 회의 기능
  - 사용 단계: 마피아 투표
  - 마피아 투표를 위해 사용자의 직업별로 카메라와 음성 환경을 조작
    - 마피아
      - 마피아끼리 카메라, 음성 사용할 수 있음
      - 마피아를 제외한 모든 사용자의 카메라 및 음성 사용 불가
    - 의사 및 시민
      - 본인을 제외한 모든 사용자의 카메라와 음성 사용 불가

- 투표 결과 확인 및 공지 기능

  | 투표 종류             | 조건                    | 공지 내용                                                    |
  | --------------------- | ----------------------- | ------------------------------------------------------------ |
  | 지목 투표             | 과반 이상의 사용자 존재 | '~~~님이 과반 이상의 표를 받게 되었습니다.'<br />'앞으로 약 10초간 @@ 님의 최후의 변론을 듣겠습니다.' |
  |                       | 과반 이상의 사용자 부재 | '아무도 과반 이상의 표를 받지 못하여 다시 토론을 진행해 주시기 바랍니다.' |
  | 사형 투표             | 과반 이상의 사용자 찬성 | '~~님의 사형에 과반 이상이 찬성하여 사형을 집행합니다.'<br />'{직업} {닉네임}님이 사망하였습니다.' |
  |                       | 과반 미만의 사용자 찬성 | '~~님의 사형에 과반 이상이 반대하여 사형을 집행하지 않습니다.' |
  | 마피아 투표+의사 투표 | 사망자 존재             | '지난 밤 {직업} {닉네임}이 사망하였습니다.'                  |
  |                       | 사망자 부재             | '지난 밤 아무도 사망하지 않았습니다.'                        |

- 마피아 투표 + 의사 투표 결과 확인 기능

  - 마피아 투표가 유효한 경우
    - 마피아 투표 == 의사 투표: 아무도 죽지 않음
    - 마피아 투표 != 의사 투표: 마피아가 선택한 사용자 죽음

  - 마피아 투표가 유효하지 않은 경우
    - 아무도 죽지 않음

- 종료 조건 확인 기능

  - 마피아가 없는 경우: 시민 승리
  - 마피아가 있는 경우
    - 생존자 중에 마피아 수 >= (시민 + 의사) 수: 마피아 승리
    - 그렇지 않은 경우: 게임 진행

- 채팅 기능
  - 게임 시작 전 모든 사용자가 사용 가능
  - 게임 시작 이후 사망자만 사용 가능
  
- 모든 사용자의 직업 확인 기능
  - 사망자의 화상에서는 모든 사용자의 직업을 확인 할 수 있다.
  
- 사용자 상태 변경 기능
  - 사용자가 사망 혹은 중간 이탈 시 해당 사용자의 상태를 사망자로 변경한다.
  - 상태를 변경한 후에 종료 조건을 확인한다.
  
- 게임 배경 화면 전환 기능

  - 낮에서 밤으로 또는 밤에서 낮으로 바뀔 때 게임 배경 화면이 바뀐다.

- 맵 커스텀 기능
  - 게임 시작 전과 후에 게임 화면을 사용자가 커스텀 할 수 있다.
  - 게임에서 제공하는 이미지 중 사용자가 마음에 드는 것을 골라 배경화면으로 지정할 수 있다.
  - 사용자는 해당 테마에서 화상회의 화면을 원하는 위치로 이동시킬 수 있다.
    - 마우스 클릭 + 드래그 + 마우스 풀기
  - 추가기능) 사용자가 원하는 사진을 맵으로 업로드해서 쓸 수 있다
  - 추가기능 ) 캡처 버튼 생성 - 캡처를 하면 sns랑 연동이되서 자동업로드 or 이미지 저장